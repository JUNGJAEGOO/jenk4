title=About
date=2013-09-24
type=page
status=published
big=
summary=
~~~~~~
## Analytics > Log&Crash Search > Getting Started

Log & Crash Searchは、次のような順序で使用します。

- 商品を有効化  
Consoleでプロジェクトを作成した後、Log & Crash商品を有効にします。
- ログ送信  
Log & Crash Search SDKを通してログ送信を開始します。
- ログの確認  
ログの送信完了後は、Log SearchあるいはApp Crash Search画面でチャットや質疑など、さまざまな方法でログを調べることができます。

## 商品有効化

Consoleに接続してLog & Crash Searchを有効にします。

```
[Analytics] > [Log & Crash Search] > [Enable]をクリック
```

> [参照]  
> 商品を有効にした後は、約5分後から送信可能です。

![[図1 : 商品有効化]](http://static.toastoven.net/prod_analytics/log_1.jpg)
<center>[図1 : 商品有効化]</center>

## AppKey確認


商品を有効にすると、Log & Crash Search用AppKeyが生成されます。ログを送信するにはAppKeyが必要です。 AppKeyの値を確認します。

```
[Analytics] > [Log & Crash Search] > [Log Search]をクリック
[AppKey]欄の値を確認
```

![[図2 : AppKey確認]](http://static.toastoven.net/prod_analytics/log_2.jpg)
<center>[図2 : AppKey確認]</center>

## ログ送信

ログを送信するにはLog & Crash Search SDKが必要です。 SDKは、DevCenter(http://cloud.toast.com)の[DOCUMENTS] > [Download]からダウンロードできます。各SDKの使い方(log4j、logback)を参照して、ログを送信してください。  

> [参照]  
> ログ量が少ない場合は、約5分後にログ送信結果が反映されます。

## ログ検索

送信したログをLog Search機能を利用して検索してみましょう。

```
[Analytics] > [Log & Crash Search] > [Log Search]をクリック
```

[Log Search]に入ると、基本的に24時間分のログ量のグラフと詳細を確認できます。

![[図3 : Log Search]](http://static.toastoven.net/prod_analytics/log_3.jpg)
<center>[図3 : Log Search]</center>

[Log Search]画面の詳細を見てみましょう。

![[図4 : Log Search詳細]](http://static.toastoven.net/prod_analytics/log_4.jpg)
<center>[図4 : Log Search詳細]</center>

|項目|	説明|
|---|---|
|検索クエリを入力|	クエリフィールド検索は、ルシーン文法を使用できます。 <br/>(参照 : http://lucene.apache.org/core/2_9_4/queryparsersyntax.html)|
|検索クエリの時間条件|	検索クエリの時間条件を設定できます。|
|ログ検索結果 >チャートビュー|	ログ検索結果を棒グラフで出力し、クリックすると、右側の単位(ex : 1Bar = 1hour)に合った期間を基準に表示します|
|フィールド検索| - host : プロジェクトに属するホストを選択するのに1つ以上のホストを選択する場合、クエリを使用します。 <br/> - logLevel : ログレベル別の表示が可能です。 (FATAL/ERROR/WARN/INFO/DEBUG)<br/> - logSource : ユーザーが設定した[ログソース]で区分します。 <br/> - logType : ユーザーが設定した[プロジェクト名]で区分します。 <br/> - projectVersion : ユーザーが設定した[プロジェクトバージョン]で区分します。 <br/> - カスタムフィールド : Setting >検索フィールドで登録したカスタムフィールドを追加して使用できます。|
|ログ検索結果 >ボディビュー|	検索したログの詳細が表示される部分です。表示されたログの各項目は、クリック可能です。|

## アプリのクラッシュ照会

Android、iOS端末のクラッシュ情報は、App Crash Searchで確認できます。

```
[Analytics] > [Log & Crash Search] > [App Crash Search]をクリック
```

### イシュー照会

![[図5-1 : イシュー照会]](http://static.toastoven.net/prod_analytics/log_5.jpg)
<center>[図5-1 : イシュー照会]</center>

![[図5-2 : Handledイシュー照会]](http://static.toastoven.net/prod_analytics/log_18.jpg)
<center>[図5-2 : Handledイシュー照会]</center>

|項目|	説明|
|---|---|
|エラータイプ|システムで発生させるCrashと、Exceptionブロックでユーザーが発生させるHandledに分類されます。|
|フィルタ条件|	状態 - クラッシュイシュー処理の状態<br/>最近 - 最近N日間に収集されたクラッシュログ照会フィルター<br/>アプリのバージョン - アプリのバージョン<br/>タグ - タグ<br/>最小発生数 - クラッシュ最小N件以上のクラッシュ照会フィルター<br/>例外の種類 - 例外の種類別最新フィルタ<br/>位置 - クラッシュ発生地点別照会フィルター|
|チャート|クラッシュの発生件数をタイムラインチャートで表示します。|
|イシューリスト|イシューリストを表示します。右上のリストボックスを利用して、並べ替え順序を変更することができ、リストの左側のチェックボックスを使用してイシューの状態を変更できます。|

リストからイシューをクリックすると、そのイシューに関する詳細情報を表示します。

![[図6 : 詳細情報]](http://static.toastoven.net/prod_analytics/log_6.jpg)
<center>[図6 : 詳細情報]</center>

|項目|	説明|
|---|---|
|状態|	イシューの状態を未解決、解決、再登録、完了などの状態に設定できます。|
|イシュートラッカーの設定|	GitHub、GitLabなどの外部課題トラッカーを設定して、そのイシューを外部課題トラッカーに登録できます。|
|タグ|	タグを追加したり、追加されたタグを変更または削除したりできます。|
|ETC - 検索ページで表示|	クリックすると、ログ検索ページに移動します。|
|ヒストリーグラフ|イシュー発生件数をタイムラインチャートとワールドマップに表示します。|
|マトリックス情報|ネットワーク、OSのバージョン、デバイス、キャリア、国の情報を表示します。|
|スタックトレース|	クラッシュが発生した例外の種類、例外の原因とスタックトレース情報を表示します。|
|エラーインスタンス|	エラーインスタンスのリストを表示します。|
|ユーザー|イシューを発生させたユーザーのリストを表示します。|
|コメント|	イシューについてコメントを作成することができ、プロジェクトメンバーが作成したコメントの一覧を表示します。|
|ヒストリー|	このイシューの管理履歴(状態の変更、タグの追加、コメントの作成など)がタイムラインに表示されます。|

### リアルタイムモニタリング

![[図7 : リアルタイムモニタリング]](http://static.toastoven.net/prod_analytics/log_7.jpg)
<center>[図7 : リアルタイムモニタリング]</center>

約5分間のアプリのクラッシュ発生を監視します。

### トレンド

![[図8 : トレンド項目内容]](http://static.toastoven.net/prod_analytics/log_8.jpg)
<center>[図8 : トレンド項目内容]</center>

|項目|	説明|
|---|---|
|時間条件|統計時間の条件を設定できます。 <br/>(7日、2週間、30日)|
|トレンドグラフ|様々なトレンドグラフを見ることができます。 <br/> - クラッシュカウント<br/> - ユーザー数<br/> - すべてのエラーの統計<br/> - 未解決エラーの統計<br/> - アプリのバージョン別のイシュー統計<br/> - OSのバージョン別のイシュー統計<br/> - デバイス別のイシュー統計<br/> - 国別のイシュー統計|

### アプリのクラッシュ指標

|項目|	説明|
|---|---|
|アプリのクラッシュ指標|	セッション/クラッシュファイル/発生率(%)/前の期間のクラッシュ/増加率(%)情報を提供します。|
|アプリのクラッシュ推移|	ユーザーが指定した期間内の発生数情報を提供します。|
|クラッシュマップ|ユーザーが指定した期間内に発生したクラッシュの数を地図上に表示します。|

細分化を指定して統計データを確認します。

1. アプリのクラッシュ指標リンクをクリックして、アプリのクラッシュ推移画面に切り替えることができます。
2. プラットフォーム(iOS、Android、、Windows)を選択して、フィルタリング検索をできます。
3. 検索期間と検索件数を調整できます。
4. バージョン別の結果をテーブルで確認できます。

![[図9 : アプリのクラッシュ指標]](http://static.toastoven.net/prod_analytics/log_11.jpg)
<center>[図9 : アプリのクラッシュ指標]</center>

![[図9-1 : クラッシュマップ]](http://static.toastoven.net/prod_analytics/crashmap_en.png)
<center>[図9-1 : クラッシュマップ]</center>

### クラッシュユーザー

ユーザーごとのクラッシュ発生情報を提供します。

1. SDKでuser_idを設定すると使用でき、設定していない場合、すべてのユーザーに、「 - 」が表示されます。
2. ユニークなユーザーは、ユーザーIDとデバイス名の組み合わせです。つまり、ユーザーIDが同じでもデバイスが異なると、別のユーザーとして集計されます。

![[図9-2 : クラッシュユーザー]](http://static.toastoven.net/prod_analytics/crashuser_en.png)
<center>[図9-2 : クラッシュユーザー]</center>

|項目|	説明|
|---|---|
|エラータイプ|	システムで発生させるCrash統計と、Exceptionブロックでユーザーが発生させるHandledに分類されます。|
|ユーザー|	SDKでuser_idに指定したユーザーIDを検索条件に設定できます。|
|デバイス|デバイス名を検索条件に設定できます。|
|時間条件|ユーザーごとのクラッシュ照会時間の条件を設定できます。|
|アプリのバージョン|アプリのバージョン別にフィルタリングします。|

### イシューの統計

![[図10-1 : イシュー統計]](http://static.toastoven.net/prod_analytics/log_9.jpg)
<center>[図10-1 : イシュー統計]</center>

![[図10-2 : Handledイシュー統計]](http://static.toastoven.net/prod_analytics/log_19.jpg)
<center>[図10-2 : Handledイシュー統計]</center>

|項目|	説明|
|---|---|
|エラータイプ|	システムで発生させるCrash統計と、Exceptionブロックでユーザーが発生させるHandled統計に分類されます。|
|時間条件|	統計時間の条件を設定できます。|
|アプリのバージョン|	アプリのバージョン別にフィルタリングします。|
|クラッシュ別発生頻度円グラフ|	クラッシュ別発生頻度を表示します。|
|クラッシュ別発生頻度順位テーブル|	クラッシュ別発生頻度順位を表示します。|

## アラーム

ログとクラッシュのアラーム設定とアラーム送信履歴を確認できます。

```
[Analytics] > [Log & Crash Search] > [Alarms]をクリック
```

### ログアラーム履歴

ログアラーム送信履歴を照会できます。
- アラーム時間を基準に検索期間を設定して検索可能で、バージョン別検索機能も提供します。
- アラーム時間、バージョン、ログレベル、しきい値、送信方法(SMS/Email)、イベント数および送信に成功したかどうかを提供します。
- また、各行をクリックすると、詳細なログメッセージとログルール情報を確認できます。

![[図11 : ログアラーム履歴]](http://static.toastoven.net/prod_analytics/alarm_01_en.png)
<center>[図11 : ログアラーム履歴]</center>

### ログアラーム設定

ログアラームリスト照会/登録/修正/削除機能を提供します。アラームを設定する方法は、次の通りです。

- アラーム名 : アラーム設定リストに表示される名前を入力します。
- ログレベル : ALL、TRACE、DEBUG、INFO、NOTICD、WARNING、ERROR、FATAL、ALERT、EMERGのいずれかの値を選択します。
- ルールの追加 : 「ルールの追加」リンクをクリックして、1つ以上のフィルタリングルールを追加できます。
- フィルタリングルール : 検索フィールド、含む文字列、含まない文字列の設定と正規表現を使用するかどうかを設定します。
- 検索フィールド : Setting >検索フィールドメニューで登録した検索フィールドの中で、分析可否がfalseの検索フィールドを選択できます。
- 含む文字列 : 検索フィールドに含める文字列を入力します。
- アラームの種類 : 「発生件数」と「増減率」の中から選択します。
- しきい値 : アラームタイプが「発生件数」の場合、1つの「アラームサイクル」内にログ量のしきい値を設定します。アラームの種類が「増減率」の場合、「比較時間」に対する増加/減少の比率をしきい値として設定します。
- アラームサイクル : 分単位で入力することができ、1分～最大60分を設定します。
- 比較サイクル : 時間単位で入力することができ、1時間～24時間を設定します。
- Snooze : 分単位で入力することができ、1分～最大1,440分(24時間)を設定します。 (0の場合off)
- 説明 : アラームの説明を記述します。
- アラーム受信者の設定 : プロジェクトメンバーのうち、アラームを受信するメンバーを選択します。
- コールバックURL : アラームが発生した時に呼び出されるURLを設定します。 http://で始まる形式をサポートします。

![[図12 : ログアラーム設定/登録]](http://static.toastoven.net/prod_analytics/alarm_02_en.png)
![[図12 : ログアラーム設定/登録]](http://static.toastoven.net/prod_analytics/alarm_03_en.png)
<center>[図12 : ログアラーム設定/登録]</center>

### クラッシュアラーム設定

クラッシュログのアラームを個別に設定する機能です。プラットフォーム(iOS、Android、、Unity)ごとに、それぞれ1つずつ登録できます。

アラームを設定する方法は、次の通りです。

- プラットフォームの選択 : アラーム発生対象のプラットフォームをiOS、Android、、Unityの中から1つ指定します。
- アラーム発生On/Off：アラーム発生のOn/Offを切り替えることができます。
- SMS通知文言の使用 : 有効にすると、障害内容の代わりにSMSアラーム文言に入力した内容が、SMSで送信されます。
- しきい値 : クラッシュ発生頻度と平均頻度のいずれかを選択して、しきい値を入力します。検出周期は10分です。
- アラーム受信者 : プロジェクトメンバーリストからアラームを受信するユーザーのEメール、SMSを選択します。

![[図13 : クラッシュアラーム設定]](http://static.toastoven.net/prod_analytics/alarm_04_en.png)
<center>[図13 : クラッシュアラーム設定]</center>

### ユーザーベースのアラーム設定

クラッシュしたユーザーの割合がしきい値(%)以上の場合、指定したユーザーの携帯電話またはEメールにアラームを送信する機能を提供します。

アラームを設定する方法は、次の通りです。

- プラットフォームの選択 : アラーム発生対象のプラットフォームをiOS、Android、、Unityの中から1つ指定します。
- アラーム発生On/Off：アラーム発生のON/OFFを切り替えることができます。
- SMSアラームフレーズの使用 : 有効にすると、障害内容の代わりにSMSアラームフレーズに入力した内容をSMSで送信します。
- しきい値 : クラッシュしたユーザーの割合がしきい値(%)以上の場合、指定したユーザーの携帯電話またはEメールにアラームを送信します。
- アラーム受信者 : プロジェクトメンバーリストからアラームを受信するユーザーのEメール、SMSを選択します。

![[図13-1 : ユーザーベースのアラーム設定]](http://static.toastoven.net/prod_analytics/alarm_05_en.png)
<center>[図13-1 : ユーザーベースのアラーム設定]</center>

## 設定

検索フィールドの管理、イシュートラッカーの設定、シンボルファイル管理などのサービスに必要な設定を管理します。

```
[Analytics] > [Log & Crash Search] > [Setting]をクリック
```

### 検索フィールド

ログ検索に使用される検索フィールドを照会する機能です。システムフィールドである既定のフィールドのリストに加えて、ユーザー送信フィールドのカスタムフィールドを確認できます。

![[図14 : 検索フィールド設定]](http://static.toastoven.net/prod_analytics/setting_01_en.png)
<center>[図14 : 検索フィールド設定]</center>

1. ログ送信時のフィールドの名前がtxtで始まる場合、分析可否がtrueに設定され、それ以外は分析可否がfalseに設定されます。分析可否がfalseの場合、ログ検索の検索フィールドに登録して使用できます。
2. ログファイルやバイナリファイルを送信し、ログ検索画面で、[ダウンロード|表示]リンクを利用する場合は、UserBinaryDataまたはUserTxtDataという名前のフィールドにbase64エンコードされた値を入れて送信してください。

### イシュートラッキング

イシュートラッカーを設定すると、App Crach Search > イシュー照会ページのイシューリストをクリックした時に移動するError Detailページ(図6参照)で、エラーをイシュートラッカーに登録して管理できます。

- プラットフォーム : iOS、Android、Unityのいずれかのプラットフォームを選択します。イシュートラッカーは、プラットフォームごとにそれぞれ1つずつ設定可能です。
- イシュートラッカー : GitHub、GitLabのいずれかを選択します。
- Issue Title Format : イシュータイトルにバージョンと位置情報を含めるかどうかを選択します。
- GitHubプロジェクトURL : イシュートラッカーをGitHubに選択した場合https://github.com/{user}/{project}形式のURLを入力します。
- Access token：イシュートラッカーをGitHubに選択した場合、GitHubで作成したAccess tokenを入力します。(参照：https://help.github.com/articles/creating-an-access-token-for-command-line-use)
- GitLabプロジェクトURL : イシュートラッカーをGitLabに選択した場合、http://{baseUrl}/{namespace}/{project}形式のURLを入力します。
- Private token : イシュートラッカーをGitLabに選択した場合、GitLabサイトのMy profile - Accountで生成されたtokenの値を入力します。
- テスト : 設定が正常かどうかをチェックします。

![[図15 : イシュートラッカー設定]](http://static.toastoven.net/prod_analytics/setting_02_en.png)
<center>[図15 : イシュートラッカー設定]</center>

### シンボルファイル

Symbolication fileが登録されていると、クラッシュログを確認できます。このメニューでは、Symbolication fileをアップロード/ダウンロード/削除できます。

- iOS : iOSシンボリケーションファイルをアップロードする時は、ZIP形式でBundleName.app.dSYMファイルを圧縮します。
- Android : Androidのシンボリケーションをアップロードする時は、mapping.txtファイルをアップロードする必要があります。
- Android-NDK : Android NDKファイルをアップロードする時は、ZIP形式でlib.soファイルを圧縮してください。
- Windows : Windowsシンボリケーションファイルをアップロードする時は、ZIP形式でBundleName.symファイルを圧縮してください。
- シンボルファイルの最大サイズは200MBです。
- Android NDKシンボリケーションファイルが許容する最大ファイルサイズを超えた場合、元の「lib.so」バイナリファイルのテキスト形式のシンボルを含んでいる「lib.so.sym」が1つ入ったZIPファイル形式にしてアップロードできます。

![[図16 : シンボルファイル管理]](http://static.toastoven.net/prod_analytics/setting_03_en.png)
<center>[図16 : シンボルファイル管理]</center>

### ログの保存期間

ログの保存期間を設定します。

- ログ保存期間は1ヶ月/ 2ヶ月/ 3ヶ月/ 6ヶ月/ 1年の中から選択することができ、月1回に限り変更可能です。
- ログ保存期間が過ぎたデータは、翌営業日の早朝、削除されます。

![[図17 : ログ保存期間]](http://static.toastoven.net/prod_analytics/setting_04_en.png)
<center>[図17 : ログ保存期間]</center>

### ログ送信設定

商品別ログを送信するかどうかを設定します。

- 一般的なログ、セッションログ、クラッシュログを送信するかどうかを設定できます。
- 設定を保存した後、APPを再起動すると適用されます。

![[図18 : ログ送信設定]](http://static.toastoven.net/prod_logncrash/setting_05_en.png)
<center>[図18 : ログ送信設定]</center>
